<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Adb on Num21</title><link>https://pangfq.github.io/blog/tags/adb/</link><description>Recent content in Adb on Num21</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Fri, 02 Feb 2024 04:14:54 -0800</lastBuildDate><atom:link href="https://pangfq.github.io/blog/tags/adb/index.xml" rel="self" type="application/rss+xml"/><item><title>adb命令</title><link>https://pangfq.github.io/blog/p/android-adb/</link><pubDate>Fri, 02 Feb 2024 04:14:54 -0800</pubDate><guid>https://pangfq.github.io/blog/p/android-adb/</guid><description>&lt;h2 id="概述">概述
&lt;/h2>&lt;p>adb，是Android Debug Bridge，Android调试桥。&lt;/p>
&lt;p>其实就是Android提供的一个命令行工具，可以与设备进行通信，方便调试。&lt;/p>
&lt;h2 id="工作原理">工作原理
&lt;/h2>&lt;p>看着小小的adb工具，其实是一个C/S架构的程序，一共涉及到3个组件：&lt;/p>
&lt;ol>
&lt;li>Client：客户端，用于发送命令。就是在电脑上打开的终端窗口，输入adb命令，就是一个adb客户端了，我们可以打开多个窗口。&lt;/li>
&lt;li>Server：服务端，用于接收命令并转发到设备。服务端在电脑上作为后台进程运行。&lt;/li>
&lt;li>adbd：守护程序，用于在设备上运行命令。守护程序在每个设备上作为后台进程运行。&lt;/li>
&lt;/ol>
&lt;h2 id="usb连接">USB连接
&lt;/h2>&lt;p>USB连接调试，就是通过数据线连接，调试之前要去“开发者模式”中把“USB调试”打开。&lt;/p>
&lt;h2 id="wifi连接">WIFI连接
&lt;/h2>&lt;p>没想到吧，还可以WIFI连接调试，但这个有点鸡肋，因为首先要用数据线连接，输入adb tcpip port 告诉设备打开一个端口建立一个TCP/IP连接，然后才能实现WIFI连接，问题是我手边有数据线还使用WIFI连接干啥？！（Android11以上的设备不需要先用数据线连接设置，可以直接到开发者模式下打开相关设置即可）&lt;/p>
&lt;p>另一个鸡肋的原因是，测试机我们不会专门给它充电，全靠上班连电脑开发时顺便充下电，所以WIFI连接用的很少，但也要知道可以实现WIFI连接调试。&lt;/p>
&lt;p>我们看下具体的操作过程（Android10及以下）：&lt;/p>
&lt;ol>
&lt;li>连接数据线&lt;/li>
&lt;li>在终端输入adb tcpip 5555，表示通知设备开始监听5555端口的tcp/ip连接&lt;/li>
&lt;li>拔掉数据线&lt;/li>
&lt;li>找到设备ip地址&lt;/li>
&lt;li>在终端输入adb connect 设备ip地址&lt;/li>
&lt;/ol>
&lt;p>断开连接：adb disconnect&lt;/p>
&lt;h2 id="常用命令">常用命令
&lt;/h2>&lt;h3 id="查看设备">查看设备
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">adb devices
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="安装应用">安装应用
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">// -r 是replace的首字母，表示覆盖安装
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adb install -r apk绝对路径
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="复制文件">复制文件
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">// 表示从手机上把某个文件复制到电脑上
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adb pull remote &lt;span class="nb">local&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// 表示从电脑上把某个文件复制到设备上
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adb push &lt;span class="nb">local&lt;/span> remote
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="停止adb服务器">停止adb服务器
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">// 如果发生一些异常情况，可以尝试停止服务器解决
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adb kill-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// 杀掉adb服务器之后，随便在终端输入任意adb命令即可重新启动adb服务器
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="指定设备发送">指定设备发送
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$ adb devices
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">List of devices attached
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">emulator-5554 device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">emulator-5555 device
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// 通过-s指定设备序列号，即可发送命令到指定设备
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ adb -s emulator-5555 install helloWorld.apk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="发送shell命令">发送shell命令
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">// 有两种方式
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// 1. 进入shell后直接使用shell命令
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ adb shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$&amp;gt;ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// 2. 不进入shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ adb shell ls
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>shell命令有很多，比如截屏、录制视频、启动activity、操作sqlite等等&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">adb shell screencap /sdcard/screen.png
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>